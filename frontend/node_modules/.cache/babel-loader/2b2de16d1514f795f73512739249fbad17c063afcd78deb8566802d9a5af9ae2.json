{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/trist/Desktop/projet-gl-main/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/trist/Desktop/projet-gl-main/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport ItemInput from '../elements/ItemInput.vue';\nimport ItemAdd from '../elements/ItemAdd.vue';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nimport { ref, computed, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport fr from '../views/fr.js';\nimport en from '../views/en.js';\nexport default {\n  components: {\n    ItemInput: ItemInput,\n    ItemAdd: ItemAdd\n  },\n  props: ['ToModPopup'],\n  setup: function setup(props) {\n    var store = useStore();\n    var idLa = computed(function () {\n      return store.state.lang.curLang;\n    });\n    var cLang = ref(idLa.value === 'fr' ? fr : en);\n\n    // Réactifs pour les champs d'entrée\n    var address = ref('');\n    var city = ref('');\n    var num = ref('');\n    watch(idLa, function (newLang) {\n      cLang.value = newLang === 'fr' ? fr : en;\n    });\n    function getUserId() {\n      return Cookies.get('matriculeProfesseur') || Cookies.get('matriculeStudent') || Cookies.get('matriculeInscription');\n    }\n    function updateUserDetails() {\n      return _updateUserDetails.apply(this, arguments);\n    }\n    function _updateUserDetails() {\n      _updateUserDetails = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var userId, addressValue, cityValue, completeAddress;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              userId = getUserId();\n              console.log(\"test de printer l'adresse : \" + address.value);\n              if (userId) {\n                _context.next = 5;\n                break;\n              }\n              console.error('User ID not found in cookies');\n              return _context.abrupt(\"return\");\n            case 5:\n              // Assurez-vous que les valeurs ne sont pas vides avant d'envoyer\n              addressValue = address.value.trim();\n              cityValue = city.value.trim();\n              completeAddress = \"\".concat(addressValue, \", \").concat(cityValue);\n              if (!(!addressValue || !cityValue || !num.value)) {\n                _context.next = 11;\n                break;\n              }\n              console.error('Address, city, or phone number is empty');\n              return _context.abrupt(\"return\");\n            case 11:\n              _context.prev = 11;\n              _context.next = 14;\n              return axios.put(\"http://localhost:1937/users/\".concat(userId, \"/address\"), completeAddress, {\n                headers: {\n                  'Content-Type': 'text/plain'\n                }\n              });\n            case 14:\n              console.log('Address updated successfully.');\n\n              // Mettre à jour le numéro de téléphone\n              _context.next = 17;\n              return axios.put(\"http://localhost:1937/users/\".concat(userId, \"/phone\"), {\n                phoneNumber: num.value\n              }, {\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 17:\n              console.log('Phone number updated successfully.');\n              _context.next = 23;\n              break;\n            case 20:\n              _context.prev = 20;\n              _context.t0 = _context[\"catch\"](11);\n              if (_context.t0.response) {\n                console.error('Error response:', _context.t0.response.data);\n              } else {\n                console.error('Error:', _context.t0.message);\n              }\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[11, 20]]);\n      }));\n      return _updateUserDetails.apply(this, arguments);\n    }\n    return {\n      cLang: cLang,\n      address: address,\n      city: city,\n      num: num,\n      getUserId: getUserId,\n      updateUserDetails: updateUserDetails,\n      ToModPopup: props.ToModPopup\n    };\n  }\n};","map":{"version":3,"names":["ItemInput","ItemAdd","axios","Cookies","ref","computed","watch","useStore","fr","en","components","props","setup","store","idLa","state","lang","curLang","cLang","value","address","city","num","newLang","getUserId","get","updateUserDetails","_updateUserDetails","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userId","addressValue","cityValue","completeAddress","wrap","_callee$","_context","prev","next","console","log","error","abrupt","trim","concat","put","headers","phoneNumber","t0","response","data","message","stop","ToModPopup"],"sources":["C:\\Users\\trist\\Desktop\\projet-gl-main\\frontend\\src\\popup\\ModifPro.vue"],"sourcesContent":["<template>\n  <div class=\"popup\">\n    <div class=\"inner\">\n      <center> \n        <div class=\"allInput\">\n        <ItemInput :name=\"cLang.EditPro.num\" v-model=\"num\"/>\n        <ItemInput :name=\"cLang.EditPro.ad\" v-model=\"address\"/>\n        <ItemInput :name=\"cLang.EditPro.city\" v-model=\"city\"/>\n      </div>\n        <ItemAdd :word=\"cLang.AddCours.ok\" @click=\"updateUserDetails\"/>\n        <ItemAdd :word=\"cLang.AddCours.back\" @click=\"ToModPopup()\"/>\n      </center>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ItemInput from '../elements/ItemInput.vue';\nimport ItemAdd from '../elements/ItemAdd.vue';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nimport { ref, computed, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport fr from '../views/fr.js';\nimport en from '../views/en.js';\n\nexport default {\n  components: { ItemInput, ItemAdd },\n  props: ['ToModPopup'],\n\n  setup(props) {\n    const store = useStore();\n    const idLa = computed(() => store.state.lang.curLang);\n    const cLang = ref(idLa.value === 'fr' ? fr : en);\n\n    // Réactifs pour les champs d'entrée\n    const address = ref('');\n    const city = ref('');\n    const num = ref('');\n\n    watch(idLa, (newLang) => {\n      cLang.value = newLang === 'fr' ? fr : en;\n    });\n\n    function getUserId() {\n      return Cookies.get('matriculeProfesseur') || Cookies.get('matriculeStudent') || Cookies.get('matriculeInscription');\n    }\n\n    async function updateUserDetails() {\n      const userId = getUserId();\n      console.log(\"test de printer l'adresse : \" + address.value)\n      if (!userId) {\n        console.error('User ID not found in cookies');\n        return;\n      }\n\n      // Assurez-vous que les valeurs ne sont pas vides avant d'envoyer\n      const addressValue = address.value.trim();\n      const cityValue = city.value.trim();\n      const completeAddress = `${addressValue}, ${cityValue}`;\n\n      if (!addressValue || !cityValue || !num.value) {\n        console.error('Address, city, or phone number is empty');\n        return;\n      }\n\n      try {\n        // Mettre à jour l'adresse\n        await axios.put(`http://localhost:1937/users/${userId}/address`, completeAddress, {\n          headers: {\n            'Content-Type': 'text/plain'\n          }\n        });\n        console.log('Address updated successfully.');\n\n        // Mettre à jour le numéro de téléphone\n        await axios.put(`http://localhost:1937/users/${userId}/phone`, { phoneNumber: num.value }, {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        console.log('Phone number updated successfully.');\n      } catch (error) {\n        if (error.response) {\n          console.error('Error response:', error.response.data);\n        } else {\n          console.error('Error:', error.message);\n        }\n      }\n    }\n\n    return {\n      cLang,\n      address,\n      city,\n      num,\n      getUserId,\n      updateUserDetails,\n      ToModPopup: props.ToModPopup\n    };\n  }\n};\n</script>\n\n<style scoped>\n\n.allInput{\n  position: relative;\n  bottom: 2.5rem;\n}\n.popup {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 99;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.inner {\n  position: relative;\n  background: rgb(255, 255, 255);\n  padding: 39px;\n  border-radius: 10%;\n}\n\n.po {\n  font-size: 30px;\n  color: rgb(134, 10, 10);\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}