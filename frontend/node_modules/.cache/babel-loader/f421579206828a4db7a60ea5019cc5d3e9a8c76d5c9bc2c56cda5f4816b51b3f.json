{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../../assets/illumis.png';\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-ff4e43aa\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"container1\"\n};\nvar _hoisted_2 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"img\", {\n    \"class\": \"logo\",\n    src: _imports_0,\n    alt: \"MyLogo\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_3 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/_createElementVNode(\"h1\", null, \"Université de la région de Kalos\", -1 /* HOISTED */);\n});\nvar _hoisted_4 = {\n  \"class\": \"input-container\"\n};\nvar _hoisted_5 = {\n  \"class\": \"input-container\"\n};\nvar _hoisted_6 = {\n  \"class\": \"forb\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_center = _resolveComponent(\"center\");\n  var _component_ItemButton = _resolveComponent(\"ItemButton\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_center, null, {\n    \"default\": _withCtx(function () {\n      return [_hoisted_2, _hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"label\", null, _toDisplayString($data.items[0].name), 1 /* TEXT */), _withDirectives(_createElementVNode(\"input\", {\n        type: \"text\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $data.email = $event;\n        })\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.email]])]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"label\", null, _toDisplayString($data.items[1].name), 1 /* TEXT */), _withDirectives(_createElementVNode(\"input\", {\n        type: \"password\",\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return $data.password = $event;\n        })\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password]])])];\n    }),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_ItemButton, {\n    name: \"Connexion\",\n    onClick: $options.submitform\n  }, null, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_router_link, {\n    to: \"/guest\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_ItemButton, {\n        name: \"Invité\"\n      })];\n    }),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["_imports_0","_createElementVNode","src","alt","_createElementBlock","_hoisted_1","_createVNode","_component_center","_withCtx","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","$data","items","name","type","_cache","$event","email","_hoisted_5","password","_","_hoisted_6","_component_ItemButton","onClick","$options","submitform","_component_router_link","to"],"sources":["/home/koluyantrez/Documents/bac3/gl/Projet-developpement-logiciel-2024-main/src/main/java/com/genieLogiciel/Umons/frontend/src/components/everyone/FirstPage.vue"],"sourcesContent":["<template>\n  <div class=\"container1\">\n    <center>\n      <img class=\"logo\" src=\"../../assets/illumis.png\" alt=\"MyLogo\">\n      <h1>Université de la région de Kalos</h1>\n      <div class=\"input-container\">\n        <label>{{ items[0].name }}</label>\n        <input type=\"text\" v-model=\"email\" />\n      </div>\n      <div class=\"input-container\">\n        <label>{{ items[1].name }}</label>\n        <input type=\"password\" v-model=\"password\" />\n      </div>\n    </center>\n    <div class=\"forb\">\n      <ItemButton name=\"Connexion\" @click=\"submitform\" />\n      <router-link to=\"/guest\">\n        <ItemButton name=\"Invité\" />\n      </router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ItemButton from '../../elements/ItemButton.vue';\nimport Cookies from 'js-cookie';\n\nfunction determineUserRole(email) {\n  if (email.endsWith(\"@Illumis.assistant.ac.be\")) {\n    return \"assistant\";\n  } else if (email.endsWith(\"@Illumis.professeur.ac.be\")) {\n    return \"professeur\";\n  } else if (email.endsWith(\"@Illumis.student.ac.be\")) {\n    return \"student\";\n  }else if (email.endsWith(\"@Illumis.inscription.ac.be\")) {\n    return \"inscription\";\n  }\n  else {\n    return \"inconnu\";\n  }\n}\nexport default {\n  components: { ItemButton },\n  data() {\n    return {\n      items: [\n        { name: 'Identifiant' },\n        { name: 'Mot de passe' }\n      ],\n      email: '',\n      password: '',\n      role: 'inconnu', // Initialisez le rôle à \"inconnu\",\n    };\n  },\n  methods: {\n    extractNumberBeforeAt(email) {\n      const atIndex = email.indexOf('@');\n      if (atIndex !== -1) {\n        const number = email.substring(0, atIndex);\n        return number;\n      } else {\n        return null;\n      }\n    },\n    submitform() {\n      const authentification = {\n        email: this.email,\n        password: this.password,\n      };\n\n      fetch('http://localhost:1937/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(authentification)\n      })\n          .then(response => {\n            this.role = determineUserRole(this.email);\n            if (response.ok) {\n              alert(\"Authentification réussie\");\n              if (this.role === 'student') {\n                // Stockage du mail et du mot de passe dans les cookies\n                Cookies.set('emailStudent', this.email);\n                Cookies.set('passwordStudent', this.password);\n                Cookies.set('role' , this.role);\n                console.log(\"cookies student : \" + Cookies.get('emailStudent'));\n                console.log(\"cookies password student \" + Cookies.get('passwordStudent'));\n                this.$router.push({\n                  name: 'student',\n                  query: {\n                    email: this.email,\n                    password: this.password\n                  }\n                });\n              } else if (this.role === 'professeur'){\n                Cookies.set('emailProfesseur', this.email);\n                Cookies.set('passwordProfesseur', this.password);\n                Cookies.set('role' , this.role);\n                this.$router.push({\n                  name: 'prof',\n                  query: {\n                    email: this.email,\n                    password: this.password\n                  }\n                });\n              }else if (this.role === 'inscription'){\n                Cookies.set('emailInscription', this.email);\n                Cookies.set('passwordInscription', this.password);\n                Cookies.set('role' , this.role);\n                const mat = this.extractNumberBeforeAt(this.email)\n                Cookies.set('matriculeInscription' , mat);\n                this.$router.push({\n                  name: 'inscription',\n                });\n              }\n            } else if (response.status === 401) {\n              alert(\"Mot de passe incorrect\");\n            } else if (response.status === 404) {\n              alert(\"User non trouvé\");\n            } else if (response.status === 500) {\n              alert(\"Erreur inattendue\");\n            } else {\n              alert(\"Erreur de serveur inattendue\");\n            }\n          })\n          .then(() => {\n            console.log(\"role : \" + this.role);\n            Cookies.set('role ' , this.role);\n            console.log(\"cookies role :  \" + this.role);\n            if (this.role === 'assistant') {\n              // Reste du code pour le rôle d'assistant\n            } else if (this.role === 'professeur') {\n              // Reste du code pour le rôle de professeur\n            } else if (this.role === 'student') {\n              // Reste du code pour le rôle d'étudiant\n            } else {\n              console.log('Rôle d\\'utilisateur inconnu');\n            }\n          })\n          .catch(error => {\n            console.error('Erreur : ', error.message);\n            alert('Erreur lors de la connexion au serveur : ' + error.message);\n          });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.container1 h1 {\n  font-family: Roboto, sans-serif;\n  font-optical-sizing: auto;\n  font-size: 3rem;\n  font-stretch: 100%;\n  font-weight: 600;\n  color: rgb(236, 181, 181);\n}\n\n.logo {\n  width: 500px;\n  height: 220px;\n}\n\n.forb {\n  display: flex;\n  flex-direction: column;\n  margin-top: 20px;\n  align-items: center;\n}\n</style>\n\n<style>\nbody {\n  background-color: rgb(131, 10, 20);\n}\n</style>"],"mappings":";;OAGwBA,UAA8B;;;;;EAF/C,SAAM;AAAY;;sBAEnBC,mBAAA,CAA8D;IAAzD,SAAM,MAAM;IAACC,GAA8B,EAA9BF,UAA8B;IAACG,GAAG,EAAC;;;;sBACrDF,mBAAA,CAAyC,YAArC,kCAAgC;AAAA;;EAC/B,SAAM;AAAiB;;EAIvB,SAAM;AAAiB;;EAKzB,SAAM;AAAM;;;;;uBAbnBG,mBAAA,CAmBM,OAnBNC,UAmBM,GAlBJC,YAAA,CAWSC,iBAAA;IAbb,WAAAC,QAAA,CAGM;MAAA,OAA8D,CAA9DC,UAA8D,EAC9DC,UAAyC,EACzCT,mBAAA,CAGM,OAHNU,UAGM,GAFJV,mBAAA,CAAkC,eAAAW,gBAAA,CAAxBC,KAAA,CAAAC,KAAK,IAAIC,IAAI,kB,gBACvBd,mBAAA,CAAqC;QAA9Be,IAAI,EAAC,MAAM;QAP1B,uBAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAOoCL,KAAA,CAAAM,KAAK,GAAAD,MAAA;QAAA;qDAALL,KAAA,CAAAM,KAAK,E,KAEnClB,mBAAA,CAGM,OAHNmB,UAGM,GAFJnB,mBAAA,CAAkC,eAAAW,gBAAA,CAAxBC,KAAA,CAAAC,KAAK,IAAIC,IAAI,kB,gBACvBd,mBAAA,CAA4C;QAArCe,IAAI,EAAC,UAAU;QAX9B,uBAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAWwCL,KAAA,CAAAQ,QAAQ,GAAAH,MAAA;QAAA;qDAARL,KAAA,CAAAQ,QAAQ,E;;IAXhDC,CAAA;MAcIrB,mBAAA,CAKM,OALNsB,UAKM,GAJJjB,YAAA,CAAmDkB,qBAAA;IAAvCT,IAAI,EAAC,WAAW;IAAEU,OAAK,EAAEC,QAAA,CAAAC;wCACrCrB,YAAA,CAEcsB,sBAAA;IAFDC,EAAE,EAAC;EAAQ;IAhB9B,WAAArB,QAAA,CAiBQ;MAAA,OAA4B,CAA5BF,YAAA,CAA4BkB,qBAAA;QAAhBT,IAAI,EAAC;MAAQ,G;;IAjBjCO,CAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}