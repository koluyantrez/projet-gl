{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-c906ff6c\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"popup\"\n};\nvar _hoisted_2 = {\n  \"class\": \"inner\"\n};\nvar _hoisted_3 = {\n  \"class\": \"allInput\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_ItemInput = _resolveComponent(\"ItemInput\");\n  var _component_ItemAdd = _resolveComponent(\"ItemAdd\");\n  var _component_center = _resolveComponent(\"center\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_center, null, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_ItemInput, {\n        name: $setup.cLang.EditPro.num,\n        modelValue: $setup.num,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.num = $event;\n        })\n      }, null, 8 /* PROPS */, [\"name\", \"modelValue\"]), _createVNode(_component_ItemInput, {\n        name: $setup.cLang.EditPro.ad,\n        modelValue: $setup.address,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return $setup.address = $event;\n        })\n      }, null, 8 /* PROPS */, [\"name\", \"modelValue\"]), _createVNode(_component_ItemInput, {\n        name: $setup.cLang.EditPro.city,\n        modelValue: $setup.city,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n          return $setup.city = $event;\n        })\n      }, null, 8 /* PROPS */, [\"name\", \"modelValue\"])]), _createVNode(_component_ItemAdd, {\n        word: $setup.cLang.AddCours.ok,\n        onClick: $setup.updateUserDetails\n      }, null, 8 /* PROPS */, [\"word\", \"onClick\"]), _createVNode(_component_ItemAdd, {\n        word: $setup.cLang.AddCours.back,\n        onClick: _cache[3] || (_cache[3] = function ($event) {\n          return $setup.ToModPopup();\n        })\n      }, null, 8 /* PROPS */, [\"word\"])];\n    }),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_center","_withCtx","_hoisted_3","_component_ItemInput","name","$setup","cLang","EditPro","num","modelValue","_cache","$event","ad","address","city","_component_ItemAdd","word","AddCours","ok","onClick","updateUserDetails","back","ToModPopup","_"],"sources":["C:\\Users\\trist\\Desktop\\projet-gl-main\\frontend\\src\\popup\\ModifPro.vue"],"sourcesContent":["<template>\n  <div class=\"popup\">\n    <div class=\"inner\">\n      <center> \n        <div class=\"allInput\">\n        <ItemInput :name=\"cLang.EditPro.num\" v-model=\"num\"/>\n        <ItemInput :name=\"cLang.EditPro.ad\" v-model=\"address\"/>\n        <ItemInput :name=\"cLang.EditPro.city\" v-model=\"city\"/>\n      </div>\n        <ItemAdd :word=\"cLang.AddCours.ok\" @click=\"updateUserDetails\"/>\n        <ItemAdd :word=\"cLang.AddCours.back\" @click=\"ToModPopup()\"/>\n      </center>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ItemInput from '../elements/ItemInput.vue';\nimport ItemAdd from '../elements/ItemAdd.vue';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nimport { ref, computed, watch } from 'vue';\nimport { useStore } from 'vuex';\nimport fr from '../views/fr.js';\nimport en from '../views/en.js';\n\nexport default {\n  components: { ItemInput, ItemAdd },\n  props: ['ToModPopup'],\n\n  setup(props) {\n    const store = useStore();\n    const idLa = computed(() => store.state.lang.curLang);\n    const cLang = ref(idLa.value === 'fr' ? fr : en);\n\n    // Réactifs pour les champs d'entrée\n    const address = ref('');\n    const city = ref('');\n    const num = ref('');\n\n    watch(idLa, (newLang) => {\n      cLang.value = newLang === 'fr' ? fr : en;\n    });\n\n    function getUserId() {\n      return Cookies.get('matriculeProfesseur') || Cookies.get('matriculeStudent') || Cookies.get('matriculeInscription');\n    }\n\n    async function updateUserDetails() {\n      const userId = getUserId();\n      console.log(\"test de printer l'adresse : \" + address.value)\n      if (!userId) {\n        console.error('User ID not found in cookies');\n        return;\n      }\n\n      // Assurez-vous que les valeurs ne sont pas vides avant d'envoyer\n      const addressValue = address.value.trim();\n      const cityValue = city.value.trim();\n      const completeAddress = `${addressValue}, ${cityValue}`;\n\n      if (!addressValue || !cityValue || !num.value) {\n        console.error('Address, city, or phone number is empty');\n        return;\n      }\n\n      try {\n        // Mettre à jour l'adresse\n        await axios.put(`http://localhost:1937/users/${userId}/address`, completeAddress, {\n          headers: {\n            'Content-Type': 'text/plain'\n          }\n        });\n        console.log('Address updated successfully.');\n\n        // Mettre à jour le numéro de téléphone\n        await axios.put(`http://localhost:1937/users/${userId}/phone`, { phoneNumber: num.value }, {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        console.log('Phone number updated successfully.');\n      } catch (error) {\n        if (error.response) {\n          console.error('Error response:', error.response.data);\n        } else {\n          console.error('Error:', error.message);\n        }\n      }\n    }\n\n    return {\n      cLang,\n      address,\n      city,\n      num,\n      getUserId,\n      updateUserDetails,\n      ToModPopup: props.ToModPopup\n    };\n  }\n};\n</script>\n\n<style scoped>\n\n.allInput{\n  position: relative;\n  bottom: 2.5rem;\n}\n.popup {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 99;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.inner {\n  position: relative;\n  background: rgb(255, 255, 255);\n  padding: 39px;\n  border-radius: 10%;\n}\n\n.po {\n  font-size: 30px;\n  color: rgb(134, 10, 10);\n}\n</style>\n"],"mappings":";;;;;EACO,SAAM;AAAO;;EACX,SAAM;AAAO;;EAET,SAAM;AAAU;;;;;uBAH3BA,mBAAA,CAYM,OAZNC,UAYM,GAXJC,mBAAA,CAUM,OAVNC,UAUM,GATJC,YAAA,CAQSC,iBAAA;IAXf,WAAAC,QAAA,CAIQ;MAAA,OAII,CAJJJ,mBAAA,CAII,OAJJK,UAII,GAHJH,YAAA,CAAoDI,oBAAA;QAAxCC,IAAI,EAAEC,MAAA,CAAAC,KAAK,CAACC,OAAO,CAACC,GAAG;QAL3CC,UAAA,EAKsDJ,MAAA,CAAAG,GAAG;QALzD,uBAAAE,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAKsDN,MAAA,CAAAG,GAAG,GAAAG,MAAA;QAAA;uDACjDZ,YAAA,CAAuDI,oBAAA;QAA3CC,IAAI,EAAEC,MAAA,CAAAC,KAAK,CAACC,OAAO,CAACK,EAAE;QAN1CH,UAAA,EAMqDJ,MAAA,CAAAQ,OAAO;QAN5D,uBAAAH,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAMqDN,MAAA,CAAAQ,OAAO,GAAAF,MAAA;QAAA;uDACpDZ,YAAA,CAAsDI,oBAAA;QAA1CC,IAAI,EAAEC,MAAA,CAAAC,KAAK,CAACC,OAAO,CAACO,IAAI;QAP5CL,UAAA,EAOuDJ,MAAA,CAAAS,IAAI;QAP3D,uBAAAJ,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAOuDN,MAAA,CAAAS,IAAI,GAAAH,MAAA;QAAA;yDAEnDZ,YAAA,CAA+DgB,kBAAA;QAArDC,IAAI,EAAEX,MAAA,CAAAC,KAAK,CAACW,QAAQ,CAACC,EAAE;QAAGC,OAAK,EAAEd,MAAA,CAAAe;oDAC3CrB,YAAA,CAA4DgB,kBAAA;QAAlDC,IAAI,EAAEX,MAAA,CAAAC,KAAK,CAACW,QAAQ,CAACI,IAAI;QAAGF,OAAK,EAAAT,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAAEN,MAAA,CAAAiB,UAAU;QAAA;;;IAV/DC,CAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}